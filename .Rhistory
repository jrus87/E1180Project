suffixUrl <- test.df
url2fetch <- paste(baseUrl, suffixUrl, sep="")
# Fetch all URLs
url2fetch <- unique(url2fetch)
url2fetch <- na.omit(url2fetch)
PlayerURLs
url2fetch
RetailerInfo <- lapply(url2fetch, FUN=function(URLLink){
Retailer <- read_html(URLLink)
Month <- Retailer %>%
html_nodes("td:nth-child(1)") %>%
html_text() %>%
as.character()
Month <-ifelse(length(nchar(Month)) !=0 , Name, 0)
Checker = data.frame(Month)
})
RetailerInfo <- lapply(url2fetch, FUN=function(URLLink){
Retailer <- read_html(URLLink)
Month <- Retailer %>%
html_nodes("td:nth-child(1)") %>%
html_text() %>%
as.character()
Month <-ifelse(length(nchar(Month)) !=0 , Month, 0)
Checker = data.frame(Month)
})
df <- do.call(rbind, RetailerInfo)
View(df)
# Setting our working directory
wrkdir <- c('C:/Users/Benji/Desktop/Statistics/Git/Repositories/E1180Project',
'~/Hertie School/Fall 2016/CollaborativeSocialScienceDataAnalysis/CSSR')
repmis::set_valid_wd(wrkdir)
# Installing packages
packages <- c('rvest', 'xml2', 'dplyr', 'magrittr', 'RSelenium')
for (p in packages) {
if (p %in% installed.packages()) require(p, character.only=TRUE)
else {
install.packages(p)
require(p, character.only=TRUE)
}
}
# Creating a BibTex file
repmis::LoadandCite(packages, file = 'RpackageCitations.bib')
# Removing from global environment for better readability
rm(packages, p, wrkdir)
# Start the pJS (which is?)
pJS <- phantom()
remDr <- remoteDriver(browserName = "phantomjs")
remDr$open(silent = FALSE)
remDr$navigate("http://www.502data.com/retailers")
# Get a data frame of all link extensions
test.html <- read_html(remDr$getPageSource()[[1]]) #html is deprecated in new version of rvest
test.text<-test.html%>%
html_nodes("a.ng-binding")%>%
html_attr("href")
test.df<-data.frame(matrix(test.text,ncol=1,byrow=TRUE))
names(test.df)<-c("name")
remDr$close()
pJS$stop()
# Subset 5 to make it more readable in quest for function
#test.df <- test.df[sample(1:nrow(test.df), 2, replace=FALSE),]
test.df
# Now use license numbers (list of 311) as reference point?
#####
# Retailers
#####
# Set base and suffix of our URL
baseUrl <- "http://www.502data.com/"
suffixUrl <- test.df
url2fetch <- paste(baseUrl, suffixUrl, sep="")
# Fetch all URLs
url2fetch <- unique(url2fetch)
url2fetch <- na.omit(url2fetch)
url2fetch
RetailerLinks <- data.frame(url2fetch)
RetailerLinks
# Create the data frame
RetailerInfo <- lapply(url2fetch, FUN=function(URLLink){
Retailer <- read_html(URLLink)
Month <- Retailer %>%
html_nodes("td:nth-child(1)") %>%
html_text() %>%
as.character()
Month <-ifelse(length(nchar(Month)) !=0 , Month, 0)
Checker = data.frame(Month)
})
df <- do.call(rbind, RetailerInfo)
baseUrl <- "http://www.502data.com/"
suffixUrl <- test.df
suffixUrl
url2fetch <- paste(baseUrl, suffixUrl, sep="")
url2fetch
test.df <- test.df[sample(1:nrow(test.df), 2, replace=FALSE),]
baseUrl <- "http://www.502data.com/"
suffixUrl <- test.df
url2fetch <- paste(baseUrl, suffixUrl, sep="")
suffixUrl
url2fetch
str(url2fetch)
# Setting our working directory
wrkdir <- c('C:/Users/Benji/Desktop/Statistics/Git/Repositories/E1180Project',
'~/Hertie School/Fall 2016/CollaborativeSocialScienceDataAnalysis/CSSR')
repmis::set_valid_wd(wrkdir)
# Installing packages
packages <- c('rvest', 'xml2', 'dplyr', 'magrittr', 'RSelenium')
for (p in packages) {
if (p %in% installed.packages()) require(p, character.only=TRUE)
else {
install.packages(p)
require(p, character.only=TRUE)
}
}
# Creating a BibTex file
repmis::LoadandCite(packages, file = 'RpackageCitations.bib')
# Removing from global environment for better readability
rm(packages, p, wrkdir)
# Start the pJS (which is?)
pJS <- phantom()
remDr <- remoteDriver(browserName = "phantomjs")
remDr$open(silent = FALSE)
remDr$navigate("http://www.502data.com/retailers")
# Get a data frame of all link extensions
test.html <- read_html(remDr$getPageSource()[[1]]) #html is deprecated in new version of rvest
test.text<-test.html%>%
html_nodes("a.ng-binding")%>%
html_attr("href")
test.df<-data.frame(matrix(test.text,ncol=1,byrow=TRUE))
names(test.df)<-c("name")
remDr$close()
pJS$stop()
# Subset 5 to make it more readable in quest for function
#test.df <- test.df[sample(1:nrow(test.df), 2, replace=FALSE),]
test.df
# Now use license numbers (list of 311) as reference point?
#####
# Retailers
#####
# Set base and suffix of our URL
baseUrl <- "http://www.502data.com/"
suffixUrl <- test.df
url2fetch <- paste(baseUrl, suffixUrl, sep="") %>%
as.character()
suffixUrl
url2fetch
test.df
TeamScrape <- read_html("http://www.transfermarkt.com/jumplist/startseite/verein/2778")
#// Get Club Name
#ClubName <- TeamScrape %>%
#html_nodes(".spielername-profil") %>%
#html_text()
#// Get All Player URLs
PlayerURLs <- TeamScrape %>%
html_nodes(".spielprofil_tooltip") %>%
html_attr("href")
PlayerURLs
RetailerURLs <- as.character(test.df)
RetailerURLs
View(test.df)
baseUrl <- "http://www.502data.com/"
suffixUrl <- test.df
suffixUrl
View(suffixUrl)
attempt <- as.character(suffixUrl)
attempt
RetailerURls <- paste0("http://www.502data.com/", test.df)
RetailerURls
RetailerURLs
# Setting our working directory
wrkdir <- c('C:/Users/Benji/Desktop/Statistics/Git/Repositories/E1180Project',
'~/Hertie School/Fall 2016/CollaborativeSocialScienceDataAnalysis/CSSR')
repmis::set_valid_wd(wrkdir)
# Installing packages
packages <- c('rvest', 'xml2', 'dplyr', 'magrittr', 'RSelenium')
for (p in packages) {
if (p %in% installed.packages()) require(p, character.only=TRUE)
else {
install.packages(p)
require(p, character.only=TRUE)
}
}
# Creating a BibTex file
repmis::LoadandCite(packages, file = 'RpackageCitations.bib')
# Removing from global environment for better readability
rm(packages, p, wrkdir)
# Start the pJS (which is?)
pJS <- phantom()
remDr <- remoteDriver(browserName = "phantomjs")
remDr$open(silent = FALSE)
remDr$navigate("http://www.502data.com/retailers")
# Get a data frame of all link extensions
test.html <- read_html(remDr$getPageSource()[[1]]) #html is deprecated in new version of rvest
test.text<-test.html%>%
html_nodes("a.ng-binding")%>%
html_attr("href")
test.df<-matrix(test.text,ncol=1,byrow=TRUE)
names(test.df)<-c("name")
remDr$close()
pJS$stop()
test.df
# Setting our working directory
wrkdir <- c('C:/Users/Benji/Desktop/Statistics/Git/Repositories/E1180Project',
'~/Hertie School/Fall 2016/CollaborativeSocialScienceDataAnalysis/CSSR')
repmis::set_valid_wd(wrkdir)
# Installing packages
packages <- c('rvest', 'xml2', 'dplyr', 'magrittr', 'RSelenium')
for (p in packages) {
if (p %in% installed.packages()) require(p, character.only=TRUE)
else {
install.packages(p)
require(p, character.only=TRUE)
}
}
# Creating a BibTex file
repmis::LoadandCite(packages, file = 'RpackageCitations.bib')
# Removing from global environment for better readability
rm(packages, p, wrkdir)
# Start the pJS (which is?)
pJS <- phantom()
remDr <- remoteDriver(browserName = "phantomjs")
remDr$open(silent = FALSE)
remDr$navigate("http://www.502data.com/retailers")
# Get a data frame of all link extensions
test.html <- read_html(remDr$getPageSource()[[1]]) #html is deprecated in new version of rvest
test.text<-test.html%>%
html_nodes("a.ng-binding")%>%
html_attr("href")
test.df<-matrix(test.text,ncol=1,byrow=TRUE)
remDr$close()
pJS$stop()
test.df
# Setting our working directory
wrkdir <- c('C:/Users/Benji/Desktop/Statistics/Git/Repositories/E1180Project',
'~/Hertie School/Fall 2016/CollaborativeSocialScienceDataAnalysis/CSSR')
repmis::set_valid_wd(wrkdir)
# Installing packages
packages <- c('rvest', 'xml2', 'dplyr', 'magrittr', 'RSelenium')
for (p in packages) {
if (p %in% installed.packages()) require(p, character.only=TRUE)
else {
install.packages(p)
require(p, character.only=TRUE)
}
}
# Creating a BibTex file
repmis::LoadandCite(packages, file = 'RpackageCitations.bib')
# Removing from global environment for better readability
rm(packages, p, wrkdir)
# Start the pJS (which is?)
pJS <- phantom()
remDr <- remoteDriver(browserName = "phantomjs")
remDr$open(silent = FALSE)
remDr$navigate("http://www.502data.com/retailers")
# Get a data frame of all link extensions
test.html <- read_html(remDr$getPageSource()[[1]]) #html is deprecated in new version of rvest
test.text<-test.html%>%
html_nodes("a.ng-binding")%>%
html_attr("href")
test.df<-matrix(test.text,byrow=TRUE)
remDr$close()
pJS$stop()
test.df
RetailerURls <- paste0("http://www.502data.com/", test.df)
RetailerURls
RetailerLinks = data.frame(RetailerURLs)
RetailerLinks
RetailerLinks = data.frame(RetailerURLs, stringsAsFactors = FALSE)
RetailerLinks
RetailerLinks = data.frame(RetailerURLs, stringsAsFactors = TRUE)
RetailerLinks
RetailerURls
RetailerURLs <- paste0("http://www.502data.com/", test.df)
RetailerURLs
RetailerInfo <- lapply(RetailerURLs, FUN=function(URLLink){
Retailer <- read_html(URLLink)
Month <- Retailer %>%
html_nodes("td:nth-child(1)") %>%
html_text() %>%
as.character()
Month <-ifelse(length(nchar(Month)) !=0 , Month, 0)
Checker = data.frame(Month)
})
RetailerURLs <- RetailerURLs[sample(1:nrow(RetailerURLs), 3, replace=FALSE),]
RetailerURLs <- unique(RetailerURLs)
RetailerURLs <- na.omit(RetailerURLs)
test.df<-data.frame(matrix(RetailerURLs,ncol=1,byrow=TRUE))
View(test.df)
RetailerLinks<-data.frame(matrix(RetailerURLs,ncol=1,byrow=TRUE))
RetailerLinks <- RetailerLinks[sample(1:nrow(RetailerLinks), 3, replace=FALSE),]
RetailerLinks
RetailerInfo <- lapply(RetailerLinksSubset, FUN=function(URLLink){
Retailer <- read_html(URLLink)
Month <- Retailer %>%
html_nodes("td:nth-child(1)") %>%
html_text() %>%
as.character()
Month <-ifelse(length(nchar(Month)) !=0 , Month, 0)
Checker = data.frame(Month)
})
RetailerLinksSubset <- RetailerLinks[sample(1:nrow(RetailerLinks), 3, replace=FALSE),]
RetailerLinksSubset
RetailerLinks<-data.frame(matrix(RetailerURLs,ncol=1,byrow=TRUE))
RetailerLinksSubset <- RetailerLinks[sample(1:nrow(RetailerLinks), 3, replace=FALSE),]
RetailerLinksSubset
# Create the data frame
RetailerInfo <- lapply(RetailerLinksSubset, FUN=function(URLLink){
Retailer <- read_html(URLLink)
Month <- Retailer %>%
html_nodes("td:nth-child(1)") %>%
html_text() %>%
as.character()
Month <-ifelse(length(nchar(Month)) !=0 , Month, 0)
Checker = data.frame(Month)
})
RetailerLinksSubset <- as.character(RetailerLinksSubset)
RetailerLinksSubset
RetailerInfo <- lapply(RetailerLinksSubset, FUN=function(URLLink){
Retailer <- read_html(URLLink)
Month <- Retailer %>%
html_nodes("td:nth-child(1)") %>%
html_text() %>%
as.character()
Month <-ifelse(length(nchar(Month)) !=0 , Month, 0)
Checker = data.frame(Month)
})
df <- do.call(rbind, RetailerInfo)
View(df)
View(df)
RetailerInfo <- lapply(RetailerLinksSubset, FUN=function(URLLink){
Retailer <- read_html(URLLink)
Month <- Retailer %>%
html_nodes("td:nth-child(1)") %>%
html_text() %>%
as.character()
Sales <- Retailer %>%
html_nodes("td:nth-child(2)") %>%
html_text() %>%
as.character()
Checker = data.frame(Month)
})
df <- do.call(rbind, RetailerInfo)
View(df)
RetailerInfo <- lapply(RetailerLinksSubset, FUN=function(URLLink){
Retailer <- read_html(URLLink)
Month <- Retailer %>%
html_nodes("td:nth-child(1)") %>%
html_text() %>%
as.character()
Sales <- Retailer %>%
html_nodes("td:nth-child(2)") %>%
html_text() %>%
as.character()
Checker = data.frame(Month, Sales)
})
df <- do.call(rbind, RetailerInfo)
View(df)
View(df)
head(df)
# Create the data frame
RetailerInfo <- lapply(RetailerLinksSubset, FUN=function(URLLink){
Retailer <- read_html(URLLink)
Name <- Retailer %>%
html_nodes("h2") %>%
html_text() %>%
as.character()
Month <- Retailer %>%
html_nodes("td:nth-child(1)") %>%
html_text() %>%
as.character()
Sales <- Retailer %>%
html_nodes("td:nth-child(2)") %>%
html_text() %>%
as.character()
ExciseTax <- Retailer %>%
html_nodes("td:nth-child(3)") %>%
html_text() %>%
as.character()
County <- Retailer %>%
html_nodes(".text-muted a") %>%
html_text() %>%
as.character()
Established <- Retailer %>%
html_nodes(".text-muted + h4") %>%
html_text() %>%
as.character()
Checker = data.frame(Name, Month, Sales, ExciseTax, County, Established)
})
df <- do.call(rbind, RetailerInfo)
head(df)
View(df)
RetailerInfo <- lapply(RetailerLinksSubset, FUN=function(URLLink){
Retailer <- read_html(URLLink)
Name <- Retailer %>%
html_nodes("h2") %>%
html_text() %>%
as.character()
Month <- Retailer %>%
html_nodes("td:nth-child(1)") %>%
html_text() %>%
as.character()
Sales <- Retailer %>%
html_nodes("td:nth-child(2)") %>%
html_text() %>%
as.character()
Sales <- mutate(Retailer, Sales=as.charachter(Sales)) %>%
mutate(Retailer, Sales=sapply(strsplit(Retailer$Sales, split='$', fixed=TRUE, function(x)(x[2]))))
ExciseTax <- Retailer %>%
html_nodes("td:nth-child(3)") %>%
html_text() %>%
as.character()
County <- Retailer %>%
html_nodes(".text-muted a") %>%
html_text() %>%
as.character()
Established <- Retailer %>%
html_nodes(".text-muted + h4") %>%
html_text() %>%
as.character()
Checker = data.frame(Name, Month, Sales, ExciseTax, County, Established)
})
# Create the data frame
RetailerInfo <- lapply(RetailerLinksSubset, FUN=function(URLLink){
Retailer <- read_html(URLLink)
Name <- Retailer %>%
html_nodes("h2") %>%
html_text() %>%
as.character()
Month <- Retailer %>%
html_nodes("td:nth-child(1)") %>%
html_text() %>%
as.character()
Sales <- Retailer %>%
html_nodes("td:nth-child(2)") %>%
html_text() %>%
as.character()
Sales <- mutate(Retailer, Sales=as.charachter(Sales))
Sales <- mutate(Retailer, Sales=sapply(strsplit(Retailer$Sales, split='$', fixed=TRUE, function(x)(x[2]))))
ExciseTax <- Retailer %>%
html_nodes("td:nth-child(3)") %>%
html_text() %>%
as.character()
County <- Retailer %>%
html_nodes(".text-muted a") %>%
html_text() %>%
as.character()
Established <- Retailer %>%
html_nodes(".text-muted + h4") %>%
html_text() %>%
as.character()
Checker = data.frame(Name, Month, Sales, ExciseTax, County, Established)
})
df$Sales <- mutate(df, Sales=as.charachter(Sales))
df$Sales <- mutate(df, Sales=as.character(Sales))
df$Sales <- mutate(df, Sales=sapply(strsplit(Retailer$Sales, split='$', fixed=TRUE, function(x)(x[2]))))
head(df)
# Create the data frame
RetailerInfo <- lapply(RetailerLinksSubset, FUN=function(URLLink){
Retailer <- read_html(URLLink)
Name <- Retailer %>%
html_nodes("h2") %>%
html_text() %>%
as.character()
Month <- Retailer %>%
html_nodes("td:nth-child(1)") %>%
html_text() %>%
as.character()
Sales <- Retailer %>%
html_nodes("td:nth-child(2)") %>%
html_text() %>%
as.character()
ExciseTax <- Retailer %>%
html_nodes("td:nth-child(3)") %>%
html_text() %>%
as.character()
County <- Retailer %>%
html_nodes(".text-muted a") %>%
html_text() %>%
as.character()
Established <- Retailer %>%
html_nodes(".text-muted + h4") %>%
html_text() %>%
as.character()
Checker = data.frame(Name, Month, Sales, ExciseTax, County, Established)
})
df <- do.call(rbind, RetailerInfo)
head(df)
df$Sales <- mutate(df, Sales=as.character(Sales))
df$Sales <- mutate(df, Sales=sapply(strsplit(Retailer$Sales, split='$', fixed=TRUE, function(x)(x[2]))))
head(df)
df <- do.call(rbind, RetailerInfo)
head(df)
df <- mutate(df, Sales=as.character(Sales))
df$Sales <- mutate(df, Sales=sapply(strsplit(Retailer$Sales, split='$', fixed=TRUE, function(x)(x[2]))))
head(df)
df <- mutate(df, Sales=as.character(Sales))
df <- mutate(df, Sales=sapply(strsplit(Retailer$Sales, split='$', fixed=TRUE, function(x)(x[2]))))
head(df)
df <- mutate(df, Sales=sapply(strsplit(df$Sales, split='$', fixed=TRUE), function(x) (x[2])))
head(df)
df <- do.call(rbind, RetailerInfo)
head(df)
df <- mutate(df, Sales=as.character(Sales)) %>%
mutate(df, Sales=sapply(strsplit(df$Sales, split='$', fixed=TRUE), function(x) (x[2])))
head(df)
df <- mutate(df, Sales=as.character(Sales))
df <- mutate(df, Sales=sapply(strsplit(df$Sales, split='$', fixed=TRUE), function(x) (x[2])))
head(df)
df <- mutate(df, ExciseTax=as.character(ExciseTax))
df <- mutate(df, ExciseTax=sapply(strsplit(df$ExciseTax, split='$', fixed=TRUE), function(x) (x[2])))
head(df)
str(df$Sales)
df$Sales <- as.numeric(gsub(",","", df$Sales))
df$ExciseTax <- as.numeric(gsub(",","", df$ExciseTax))
head(df)
